---
title: "CocoaPodsã®Specã‚’æ›´æ–°ã—ã‚ˆã†ã¨æ€ã£ãŸã‚‰ã€VisionOSãŒçµ¡ã‚“ã§lintãŒé€šã‚‰ãªã‹ã£ãŸè©±"
emoji: "ğŸ¥·"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["cocoapods", "iOS"]
published: false
---

ã€Œã‚ˆã—ã€‚æ”¹ä¿®ã‚‚çµ‚ã‚ã‚Šã€‚ã‚ã¨ã¯Specãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°ã‚’åŠ ãˆã¦å…¬é–‹ã™ã‚‹ã ã‘ã ãªã€‚ã€

`pod spec lint` â€¦â€¦ ERROR

ã€ŒğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ğŸ¤”ã€

## ã‚ã‚‰ã™ã˜

- CocoaPodsã¸ç™»éŒ²ã™ã‚‹ä½œæ¥­ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦é€²ã‚ãªããªã£ãŸ
- `pod spec lint Example.podspec` ã¨ã—ãŸãŒã€ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¦ã—ã¾ã£ã¦é€²è¡Œã§ããªã„

```shell-session
 pod spec lint Example.podspec

-> Pod installation complete! There is 1 dependency from the Podfile and 1 total pod installed.
   Building with `xcodebuild`.
 -> Example (1.0.0)
    - ERROR | [iOS] unknown: Encountered an unknown error (unexpected token at 'objc[56344]: Class XROS1_0SimRuntime is implemented in both /Library/Developer/CoreSimulator/Volumes/xrOS_21N305/Library/Developer/CoreSimulator/Profiles/Runtimes/xrOS 1.0.simruntime/Contents/MacOS/xrOS 1.0 (0x104dd00e0) and /Library/Developer/CoreSimulator/Volumes/xrOS_21N5165g/Library/Developer/CoreSimulator/Profiles/Runtimes/xrOS 1.0.simruntime/Contents/MacOS/xrOS 1.0 (0x106dac0e0). One of the two will be used. Which one is undefined.
# ã€œã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã€œ
'
) during validation.
```

## ã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã®è§£èª­

- ä¸æ˜ãªã‚¨ãƒ©ãƒ¼ã«é­é‡ã—ãŸã‚‰ã—ã„
    - æœŸå¾…ã—ã¦ã„ãªã„ãƒˆãƒ¼ã‚¯ãƒ³ã¨ã¯ï¼Ÿ
- `Class XROS1_0SimRuntime is implemented in both`
    - `/Library/Developer/CoreSimulator/Volumes/xrOS_21N305/Library/Developer/CoreSimulator/Profiles/Runtimes/xrOS 1.0.simruntime/Contents/MacOS/xrOS 1.0 (0x104dd00e0)`
    - `/Library/Developer/CoreSimulator/Volumes/xrOS_21N5165g/Library/Developer/CoreSimulator/Profiles/Runtimes/xrOS 1.0.simruntime/Contents/MacOS/xrOS 1.0 (0x106dac0e0)`
    - ã©ã¡ã‚‰ã‹ãŒä½¿ã‚ã‚Œã‚‹ãŒæœªå®šç¾©ã§ã‚ã‚‹ã¨ã„ã†æ–‡è¨€
- xrOSã£ã¦AppleVisionç”¨ã®OSã£ã½ã„

### ã‚¹ã‚¿ãƒƒã‚¯ãƒˆãƒ¬ãƒ¼ã‚¹ã‚’è¦‹ã‚‹

```shell-session
/(çœç•¥)/gems/json-2.7.1/lib/json/common.rb:219:in `parse'
/(çœç•¥)/gems/json-2.7.1/lib/json/common.rb:219:in `parse'
/(çœç•¥)/gems/fourflusher-2.3.1/lib/fourflusher/find.rb:125:in `fetch_sims'
/(çœç•¥)/gems/fourflusher-2.3.1/lib/fourflusher/find.rb:101:in `usable_simulators'
/(çœç•¥)/gems/fourflusher-2.3.1/lib/fourflusher/find.rb:97:in `simulator'
/(çœç•¥)/gems/fourflusher-2.3.1/lib/fourflusher/xcodebuild.rb:7:in `destination'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/validator.rb:1095:in `xcodebuild'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/validator.rb:743:in `block in build_pod'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/user_interface.rb:149:in `message'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/validator.rb:723:in `build_pod'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/validator.rb:410:in `block in perform_extensive_analysis'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/validator.rb:398:in `each'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/validator.rb:398:in `perform_extensive_analysis'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/validator.rb:129:in `validate'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/command/spec/lint.rb:90:in `block in run'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/command/spec/lint.rb:71:in `each'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/command/spec/lint.rb:71:in `run'
/(çœç•¥)/gems/claide-1.1.0/lib/claide/command.rb:334:in `run'
/(çœç•¥)/gems/cocoapods-1.15.2/lib/cocoapods/command.rb:52:in `run'
/(çœç•¥)/gems/cocoapods-1.15.2/bin/pod:55:in `<top (required)>'
/(çœç•¥)/bin/pod:23:in `load'
/(çœç•¥)/bin/pod:23:in `<top (required)>'
```

- ã©ã†ã‚„ã‚‰ JSON parser ã«æœŸå¾…ã—ãªã„ãƒˆãƒ¼ã‚¯ãƒ³ãŒæµã‚Œè¾¼ã‚“ã ã‚‰ã—ã„
    - `objc[~~]` ä»¥é™ã®ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã™ã¹ã¦
- `fourflusher/find.rb` ãŒ JSON parser ã«ã‚ãŸã™ç®‡æ‰€ã«ç•°å¸¸ãŒã‚ã‚‹ï¼Ÿ

## åŸå› ã‚’èª¿æŸ»ã™ã‚‹

### fourflusher/find.rb ã‚’è¦‹ã‚‹

```rb
    def fetch_sims
      device_list = JSON.parse(list(['-j', 'devices']))['devices']
      # çœç•¥
    end
```

https://github.com/CocoaPods/fourflusher/blob/b1d9bbbdb35d577b2c6d7d77e3f7770b03d34ae1/lib/fourflusher/find.rb#L125

- `list` é–¢æ•°ã®çµæœãŒãŠã‹ã—ã„ã‚‰ã—ã„
    - GitHubã®è£œåŠ©ã„ã‚ãã€ã“ã®é–¢æ•°ã¯ `fourflusher/simctr.rb` ã«å®šç¾©ã•ã‚Œã¦ã„ã‚‹ã‚‰ã—ã„

### fourflusher/simctr.rb ã‚’è¦‹ã‚‹

```rb
require 'fourflusher/executable'

module Fourflusher
  # Executes `simctl` commands
  class SimControl
    extend Executable
    executable :xcrun

    def list(args)
      simctl!(['list'] + args)
    end

    private

    def simctl!(args)
      xcrun!(['simctl'] + args)
    end
  end
end
```

https://github.com/CocoaPods/fourflusher/blob/b1d9bbbdb35d577b2c6d7d77e3f7770b03d34ae1/lib/fourflusher/simctl.rb#L9-L17

- `list(args)` ã¯ã©ã†ã‚„ã‚‰ `simctl!(args)` ã‚’å‘¼ã³å‡ºã™ãŸã‚ã®ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ã‚‰ã—ã„
- ãã—ã¦ `simctl!(args)` ã¯ `xcrun!(args)` ã‚’å‘¼ã³å‡ºã™ãŸã‚ã®ã‚·ãƒ§ãƒ¼ãƒˆãƒãƒ³ãƒ‰ã‚‰ã—ã„
- ã“ã®æ™‚ç‚¹ã§ã€ç›´æ„Ÿçš„ã«ã¯ `xcrun` ã‚³ãƒãƒ³ãƒ‰ã‚’å©ã„ã¦ã„ã‚‹ã‚‚ã®ã¨æƒ³å®šã§ãã‚‹
    - `fourflusher/executable` ã‚’ç¢ºèªã—ãŸã¨ã“ã‚ã€ã‚³ãƒãƒ³ãƒ‰ã‚’çµ„ã¿ç«‹ã¦ã¦å®Ÿè¡Œã—ã€çµæœã‚’å–ã‚Šè¾¼ã‚“ã§ã„ãŸ

ã¤ã¾ã‚Šã€JSON parser ã«æ¸¡ã•ã‚Œã¦ã„ã‚‹å†…å®¹ã¯ã‚³ãƒãƒ³ãƒ‰ã®å®Ÿè¡Œçµæœã§ã‚ã‚‹ã€‚

### ã‚³ãƒãƒ³ãƒ‰ã‚’å©ã„ã¦ã¿ã‚‹

```shell-session
xcrun simctl list -j devices > /dev/null

objc[56969]: Class XROS1_0SimRuntime is implemented in both /Library/Developer/CoreSimulator/Volumes/xrOS_21N305/Library/Developer/CoreSimulator/Profiles/Runtimes/xrOS 1.0.simruntime/Contents/MacOS/xrOS 1.0 (0x1033f80e0) and /Library/Developer/CoreSimulator/Volumes/xrOS_21N5165g/Library/Developer/CoreSimulator/Profiles/Runtimes/xrOS 1.0.simruntime/Contents/MacOS/xrOS 1.0 (0x1053d40e0). One of the two will be used. Which one is undefined.
```

- åŒã‚³ãƒãƒ³ãƒ‰ã®å†…å®¹ã‚’ `jq` ã«æµã—ãŸã¨ã“ã‚å•é¡Œã¯ãªã‹ã£ãŸ
    - ã¤ã¾ã‚Šã€æ¨™æº–å‡ºåŠ›ã®å†…å®¹ã¯å•é¡Œãªã•ãã†ã ã£ãŸ
- æ¨™æº–ã‚¨ãƒ©ãƒ¼å‡ºåŠ›ã®å†…å®¹ãŒä¸€è‡´ã—ãŸ

### åŸå› ã¯ã©ã“ã§ã‚ã‚‹ã‹ï¼Ÿ

- `fourflusher/executable` ãŒæ¨™æº–å‡ºåŠ›ã‚‚æ¨™æº–ã‚¨ãƒ©ãƒ¼ã‚‚ã¾ã¨ã‚ã¦å‡ºåŠ›ã—ã¦ã‚‹ã®ã¯è‰¯ããªã„ã‚“ã˜ã‚ƒãªã„ã®ã‹
- ãã‚‚ãã‚‚ Apple ã®æä¾›ã™ã‚‹ã‚³ãƒãƒ³ãƒ‰ãƒ©ã‚¤ãƒ³ãƒ„ãƒ¼ãƒ« `xcrun` ãŒé‡è¤‡ã—ãŸã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’åŸ‹ã‚è¾¼ã‚“ã§ã—ã¾ã†ã®ãŒæ‚ªã„ã‚“ã˜ã‚ƒãªã„ã‹

## ã©ã†ã™ã¹ã

- ãƒ€ãƒ–ã£ã¦ã‚‹ `xrOS` ã‚’é™¤å»ã—ãŸã„ã­
    - ã©ã“ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸã®ã ã‚ã†ï¼Ÿ
        - ç’°å¢ƒã«å°å…¥ã•ã‚Œã¦ã„ã‚‹Xcodeã¯
            - Xcode 14.1
            - Xcode 15.0.1
            - Xcode 15.2 (AppStore)
        - Xcode ã”ã¨ã«VisionOSã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’ç¢ºèªã—ã¦ã¿ã‚‹
            - Xcode 15.2 ã§ã®ã¿ã€Device and Simulator ã‹ã‚‰ `21N305` ã‚’ç¢ºèªã§ããŸ
                - ã¤ã¾ã‚Šãƒ¢ãƒ‡ãƒ«åã‚‰ã—ã„
                    - `21N5165g` ã‚’ã‹ã‚‹ãæ¤œç´¢ã—ã¦ã¿ãŸã¨ã“ã‚ã€ VisionOS 1.0 Beta 1ã®ãƒ¢ãƒ‡ãƒ«åã‚‰ã—ã„
- æ¶ˆã›ã°ãªã‚“ã¨ã‹ãªã‚‹ã®ã§ã¯ï¼Ÿ
    - `xcrun simctl list` ã‚’çœºã‚ã¦ã¿ã‚‹ã¨ã€å•é¡Œã¯ `Runtime` ã«ã‚ã‚‹ã‚‰ã—ã„
    - `xcrun simctl help` ã‚’å©ã„ã¦ã¿ã‚‹ã¨ã€ `runtime` ã¨ã„ã†ã‚µãƒ–ã‚³ãƒãƒ³ãƒ‰ãŒã‚ã£ãŸ
    - `xcrun simctl runtime help` ã‚’å©ã„ãŸã¨ã“ã‚ã€ `add|delete|list` ãŒè¦‹å—ã‘ã‚‰ã‚ŒãŸ 

### æ¶ˆãã†ã€ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã€‚

```shell-session
xcrun simctl runtime list

== Disk Images ==
-- iOS --
iOS 17.2 (21C62) - D6D0354A-CFBA-4ACA-8822-0D5E24C33E9F (Ready)
iOS 17.0.1 (21A342) - C8355079-AB6B-4B44-98D7-3574515C8646 (Ready)
iOS 17.0 (21A5268h) - 6BA83493-ADA5-4D2C-B09F-1A5B7BDE5505 (Ready)
-- xrOS --
xrOS 1.0 (21N5165g) - A50B8FE4-D630-40F1-9E99-07426329D58D (Ready)
xrOS 1.0 (21N305) - 7FC5D98B-702A-4B63-ACB3-88C400AD4295 (Ready)

Total Disk Images: 5 (34.1G)
```

å„imageã«UUIDãŒæŒ¯ã‚‰ã‚Œã¦ã„ã‚‹ã¨ã‚ã‹ã‚‹

```shell-session
xcrun simctl runtime delete -n A50B8FE4-D630-40F1-9E99-07426329D58D

Would delete D: A50B8FE4-D630-40F1-9E99-07426329D58D xrOS (1.0 - 21N5165g) (Ready)
```

`--dry-run`(`-n`) ã‚’ã‹ã‘ã¦ã€äºˆè¡Œæ¼”ç¿’ã§ãã‚‹ã€‚

```shell-session
xcrun simctl runtime delete A50B8FE4-D630-40F1-9E99-07426329D58D
```

æ¶ˆã—ã¦ã¿ãŸã®ã§ã€ç¢ºèªã—ã¦ã¿ã‚‹ã€‚

```
xcrun simctl runtime list

== Disk Images ==
-- iOS --
iOS 17.2 (21C62) - D6D0354A-CFBA-4ACA-8822-0D5E24C33E9F (Ready)
iOS 17.0.1 (21A342) - C8355079-AB6B-4B44-98D7-3574515C8646 (Ready)
iOS 17.0 (21A5268h) - 6BA83493-ADA5-4D2C-B09F-1A5B7BDE5505 (Ready)
-- xrOS --
xrOS 1.0 (21N305) - 7FC5D98B-702A-4B63-ACB3-88C400AD4295 (Ready)

Total Disk Images: 4 (27.2G)
```

æ¶ˆãˆãŸï¼

`xcrun simctl list` â€¦â€¦ ã‚¨ãƒ©ãƒ¼ãªã—ï¼

`pod spec lint` â€¦â€¦ ã‚¨ãƒ©ãƒ¼ãªã—ï¼

è§£æ±ºï¼


## ã•ãå›ã‚‚å£Šã—ã¦ã¿ã‚ˆã†

1. ã™ã§ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã‚’ç¢ºèªã™ã‚‹
    - AppStore ã‹ã‚‰ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ãŸXcode 15.2 ã«ä»˜å±ã™ã‚‹ã€`xrOS 1.0` ã™ãªã‚ã¡ `VisionOS 1.0` æ­£å¼ç‰ˆãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚Œã¦ã„ã‚‹ã‚‚ã®ã¨ã™ã‚‹
2. Apple Developer ã® Download ãƒšãƒ¼ã‚¸ã‹ã‚‰ã€ `VisionOS 1.0 Beta 2` ã‚’ãƒ€ã‚¦ãƒ³ãƒ­ãƒ¼ãƒ‰ã™ã‚‹
    - 2024-03-15 ç¾åœ¨ã§æ‰‹ã«å…¥ã‚‹å¤ã„ VisionOS 1.0 ã® Betaç‰ˆ
3. `xcrun simctl runtime add '~/Downloads/visionOS_1_beta_2_Simulator_Runtime.dmg'` ã‚’å®Ÿè¡Œã™ã‚‹
4. å†ç¾å®Œäº†ï¼

### èª°ãŒåŸå› ã ã£ãŸï¼Ÿ

- VisionOS ã® Betaå…¬é–‹ã«é£›ã³ã¤ã„ãŸç­†è€…è‡ªèº«ï¼Ÿ
- iOS runtime ã® Beta ã§ã¯å†ç¾ã§ããªã‹ã£ãŸã‹ã‚‰ã‚„ã£ã±ã‚Š Apple ãŒæ‚ªã„ã‚ˆ
